# 项目决策记录

> **本文档记录所有重大技术决策**
> **从CLAUDE.md迁移而来，避免主文件过大**

---

## 决策记录

### [决策 #001] 2025-10-13 - 适配器模式支持多AI
**问题**：如何支持多个AI平台？
**方案**：每个AI实现统一的`IAIProvider`接口
**原因**：解耦、易扩展、测试友好
**影响**：所有Provider必须实现login()、query()、logout()方法

---

### [决策 #002] 2025-10-13 - SQLite数据库
**问题**：如何存储查询结果？
**方案**：SQLite本地数据库
**原因**：轻量、无需额外服务、跨平台、便于备份
**影响**：结果存储在本地.db文件中

---

### [决策 #003] 2025-10-18 - 界面形式从Web GUI改为TUI
**问题**：用户需要GUI界面还是CLI命令？
**方案**：采用TUI（Terminal User Interface）- 终端内的图形化交互界面
**原因**：
- 不需要浏览器，在终端内完成所有交互
- 使用blessed框架实现ASCII界面（框、表格、进度条）
- 支持键盘导航（上下键、空格多选、Tab切换）
- 开发周期保持2周（无需开发Web前端）

**影响**：
- 技术栈：不需要Electron、React
- 新增依赖：blessed、cli-table3、boxen
- 代码结构：src/cli → src/tui

---

### [决策 #004] 2025-10-18 - 演示模式作为任务管理的输出选项
**问题**：演示模式应该作为独立界面还是选项？
**方案**：在任务管理界面（Level 1-B）中作为"输出模式"的单选项
**原因**：
- 用户在一个界面选择"演示模式"或"写库模式"更直观
- 减少界面导航复杂度
- 演示模式只影响执行结果的处理方式，逻辑上属于任务配置

**影响**：
- Level 1-B增加第4步"输出模式选择"
- Level 2和Level 3分为A/B两个分支（演示/写库）
- 总界面数：6个（包含执行中和结果展示的分支）

---

### [决策 #005] 2025-10-18 - 三种并行模式统一设计
**问题**：如何支持用户不同的性能需求？
**方案**：提供三种执行模式 + 自动推荐
- **串行模式**：保底方案，速度慢，内存低（~500MB）
- **方案A - 多AI应用并行**：多个MCP实例，3个AI同时跑，快3倍
- **方案B - 单AI多问题并行**：Puppeteer多Page，10问题同时跑，快10倍
- **自动选择模式**：系统根据可用内存/CPU推荐并发数

**原因**：
- 用户系统资源不同，需要灵活选择
- 串行模式作为保底，保证所有环境都能运行
- 自动模式降低使用门槛

**影响**：
- Phase 2.6/2.7分开开发两种并行方案，每个都要用户确认效果
- 新增系统资源评估模块（TASKS 2.5）
- QueryService需要支持三种模式切换

---

### [决策 #006] 2025-10-13 - 项目独立安装chrome-devtools-mcp
**问题**：是否复用test1的chrome-devtools-mcp？
**方案**：新项目通过npm独立安装标准版chrome-devtools-mcp
**原因**：test1的版本已被修改（混入业务代码），新项目需要干净的架构
**影响**：test1的豆包代码需要拷贝到新项目并调整import路径

---

### [决策 #007] 2025-10-13 - 文档驱动的跨窗口协作
**问题**：如何避免多个Claude窗口导致项目失控？
**方案**：6个核心文档 + 三大Checklist + 严格的执行规范
**原因**：保证一致性、可追溯、质量可控
**影响**：每次开发前后都要执行规范的checklist操作

---

**Last Updated**: 2025-10-18 21:30
**Status**: 活跃使用中
